{"ast":null,"code":"import _jsx from \"@babel/runtime/helpers/jsx\";\n\n/* eslint no-undef: \"error\" */\n\n/* eslint-env browser */\nimport React, { useContext, useEffect } from 'react';\nimport Camera from 'react-html5-camera-photo';\nimport PageLoader from 'Lib/Pageloader';\nimport { AppContext } from '../../context';\nimport PageHeader from '../../Components/PageHeaders';\nimport FileUploadButton from '../../Components/FileUploadButton';\nimport ImagePreview from '../ImagePreview';\nimport FileIcon from '../../icons/file.png';\nimport ClickIcon from '../../icons/click.png';\n\nvar CameraView = function CameraView() {\n  var _useContext = useContext(AppContext),\n      dataUri = _useContext.dataUri,\n      setCroppedDataUri = _useContext.setCroppedDataUri,\n      updateCameraFlag = _useContext.updateCameraFlag,\n      updatePreviewFlag = _useContext.updatePreviewFlag,\n      updateFileFlag = _useContext.updateFileFlag,\n      setDataUri = _useContext.setDataUri,\n      showCamera = _useContext.showCamera,\n      showPreview = _useContext.showPreview,\n      showFileUpload = _useContext.showFileUpload,\n      uploadSelectedPhoto = _useContext.uploadSelectedPhoto,\n      croppedDataUri = _useContext.croppedDataUri,\n      updateCodeFlag = _useContext.updateCodeFlag,\n      pageLoader = _useContext.pageLoader;\n\n  useEffect(function () {\n    var cam = document.getElementsByTagName('video');\n\n    if (cam && cam.length) {\n      cam[0].style.transform = '';\n    }\n  }, [showCamera]);\n\n  var handleTakePhotoAnimationDone = function handleTakePhotoAnimationDone(dui) {\n    setDataUri(dui);\n    updateCameraFlag(false);\n    updatePreviewFlag(true);\n    updateFileFlag(false);\n  };\n\n  var base64ToBlob = function base64ToBlob(base64, mime) {\n    var mimeSet = mime || '';\n    var sliceSize = 1024;\n    var byteChars = window.atob(base64);\n    var byteArrays = [];\n\n    for (var offset = 0, len = byteChars.length; offset < len; offset += sliceSize) {\n      var slice = byteChars.slice(offset, offset + sliceSize);\n      var byteNumbers = new Array(slice.length);\n\n      for (var i = 0; i < slice.length; i += 1) {\n        byteNumbers[i] = slice.charCodeAt(i);\n      }\n\n      var byteArray = new Uint8Array(byteNumbers);\n      byteArrays.push(byteArray);\n    }\n\n    return new Blob(byteArrays, {\n      type: mimeSet\n    });\n  };\n\n  var selectPhoto = function selectPhoto() {\n    var base64ImageContent = croppedDataUri.replace(/^data:image\\/(png|jpg);base64,/, '');\n    var blob = base64ToBlob(base64ImageContent, 'image/png');\n    var formData = new FormData();\n    formData.append('file', new File([blob], 'picture.jpg'));\n    updateCodeFlag(true);\n    updateCameraFlag(false);\n    updatePreviewFlag(false);\n    uploadSelectedPhoto(formData);\n    updateFileFlag(false);\n  };\n\n  var isFullscreen = false;\n  return (\n    /*#__PURE__*/\n    _jsx(\"div\", {}, void 0, showPreview ? [\n    /*#__PURE__*/\n    _jsx(ImagePreview, {\n      dataUri: dataUri,\n      isFullscreen: isFullscreen,\n      setDataUri: setCroppedDataUri\n    }, \"0\"),\n    /*#__PURE__*/\n    _jsx(\"button\", {\n      type: \"button\",\n      className: \"Button--secondary\",\n      onClick: selectPhoto\n    }, \"1\", \"Select your image\")] : null, showCamera ? [\n    /*#__PURE__*/\n    _jsx(PageHeader, {\n      imageSrc: ClickIcon,\n      title: \"Take a picture\",\n      subtitle: \"Position the camera, so that all the code is visible in the frame.\"\n    }, \"0\"),\n    /*#__PURE__*/\n    _jsx(\"div\", {\n      className: \"bg-white pl-10 pt-10 pb-10 pr-10\"\n    }, \"1\",\n    /*#__PURE__*/\n    _jsx(Camera, {\n      onTakePhotoAnimationDone: handleTakePhotoAnimationDone,\n      idealFacingMode: \"environment\",\n      isFullscreen: isFullscreen\n    }))] : null, showFileUpload ? [\n    /*#__PURE__*/\n    _jsx(PageHeader, {\n      imageSrc: FileIcon,\n      title: \"Upload your image\",\n      subtitle: \"If you have a picture taken earlier, you can add it here.\"\n    }, \"0\"),\n    /*#__PURE__*/\n    _jsx(\"div\", {}, \"1\",\n    /*#__PURE__*/\n    _jsx(FileUploadButton, {}))] : null, pageLoader ?\n    /*#__PURE__*/\n    _jsx(PageLoader, {\n      title: \"Uploading your image\",\n      message: \"Please wait while we fetch your code\"\n    }) : null)\n  );\n};\n\nvar _default = CameraView;\nexport default _default;\n;\n\nvar _temp = function () {\n  if (typeof __REACT_HOT_LOADER__ === 'undefined') {\n    return;\n  }\n\n  __REACT_HOT_LOADER__.register(CameraView, \"CameraView\", \"/home/krishnamohan/projects/major/code_runner_ui/src/Containers/CameraView/index.jsx\");\n\n  __REACT_HOT_LOADER__.register(_default, \"default\", \"/home/krishnamohan/projects/major/code_runner_ui/src/Containers/CameraView/index.jsx\");\n}();\n\n;","map":{"version":3,"sources":["/home/krishnamohan/projects/major/code_runner_ui/src/Containers/CameraView/index.jsx"],"names":["React","useContext","useEffect","Camera","PageLoader","AppContext","PageHeader","FileUploadButton","ImagePreview","FileIcon","ClickIcon","CameraView","dataUri","setCroppedDataUri","updateCameraFlag","updatePreviewFlag","updateFileFlag","setDataUri","showCamera","showPreview","showFileUpload","uploadSelectedPhoto","croppedDataUri","updateCodeFlag","pageLoader","cam","document","getElementsByTagName","length","style","transform","handleTakePhotoAnimationDone","dui","base64ToBlob","base64","mime","mimeSet","sliceSize","byteChars","window","atob","byteArrays","offset","len","slice","byteNumbers","Array","i","charCodeAt","byteArray","Uint8Array","push","Blob","type","selectPhoto","base64ImageContent","replace","blob","formData","FormData","append","File","isFullscreen"],"mappings":"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","sourcesContent":["/* eslint no-undef: \"error\" */\n/* eslint-env browser */\nimport React, { useContext, useEffect } from 'react'\nimport Camera from 'react-html5-camera-photo'\nimport PageLoader from 'Lib/Pageloader'\nimport { AppContext } from '../../context'\nimport PageHeader from '../../Components/PageHeaders'\nimport FileUploadButton from '../../Components/FileUploadButton'\nimport ImagePreview from '../ImagePreview'\nimport FileIcon from '../../icons/file.png'\nimport ClickIcon from '../../icons/click.png'\n\nconst CameraView = () => {\n  const {\n    dataUri,\n    setCroppedDataUri,\n    updateCameraFlag,\n    updatePreviewFlag,\n    updateFileFlag,\n    setDataUri,\n    showCamera,\n    showPreview,\n    showFileUpload,\n    uploadSelectedPhoto,\n    croppedDataUri,\n    updateCodeFlag,\n    pageLoader\n  } = useContext(AppContext)\n\n  useEffect(() => {\n    const cam = document.getElementsByTagName('video')\n    if (cam && cam.length) {\n      cam[0].style.transform = ''\n    }\n  }, [showCamera])\n\n  const handleTakePhotoAnimationDone = dui => {\n    setDataUri(dui)\n    updateCameraFlag(false)\n    updatePreviewFlag(true)\n    updateFileFlag(false)\n  }\n\n  const base64ToBlob = (base64, mime) => {\n    const mimeSet = mime || ''\n    const sliceSize = 1024\n    const byteChars = window.atob(base64)\n    const byteArrays = []\n\n    for (let offset = 0, len = byteChars.length; offset < len; offset += sliceSize) {\n      const slice = byteChars.slice(offset, offset + sliceSize)\n      const byteNumbers = new Array(slice.length)\n      for (let i = 0; i < slice.length; i += 1) {\n        byteNumbers[i] = slice.charCodeAt(i)\n      }\n      const byteArray = new Uint8Array(byteNumbers)\n      byteArrays.push(byteArray)\n    }\n    return (new Blob(byteArrays, { type: mimeSet }))\n  }\n\n  const selectPhoto = () => {\n    const base64ImageContent = croppedDataUri.replace(/^data:image\\/(png|jpg);base64,/, '')\n    const blob = base64ToBlob(base64ImageContent, 'image/png')\n    const formData = new FormData()\n    formData.append('file', new File([blob], 'picture.jpg'))\n    updateCodeFlag(true)\n    updateCameraFlag(false)\n    updatePreviewFlag(false)\n    uploadSelectedPhoto(formData)\n    updateFileFlag(false)\n  }\n\n  const isFullscreen = false\n\n  return (\n    <div>\n      <If condition={showPreview}>\n        <ImagePreview\n          dataUri={dataUri}\n          isFullscreen={isFullscreen}\n          setDataUri={setCroppedDataUri}\n        />\n        <button\n          type=\"button\"\n          className=\"Button--secondary\"\n          onClick={selectPhoto}\n        >\n          Select your image\n        </button>\n      </If>\n      <If condition={showCamera}>\n        <PageHeader\n          imageSrc={ClickIcon}\n          title=\"Take a picture\"\n          subtitle=\"Position the camera, so that all the code is visible in the frame.\"\n        />\n        <div className=\"bg-white pl-10 pt-10 pb-10 pr-10\">\n          <Camera\n            onTakePhotoAnimationDone={handleTakePhotoAnimationDone}\n            idealFacingMode=\"environment\"\n            isFullscreen={isFullscreen}\n          />\n        </div>\n      </If>\n      <If condition={showFileUpload}>\n        <PageHeader\n          imageSrc={FileIcon}\n          title=\"Upload your image\"\n          subtitle=\"If you have a picture taken earlier, you can add it here.\"\n        />\n        <div>\n          <FileUploadButton />\n        </div>\n      </If>\n      <If condition={pageLoader}>\n        <PageLoader\n          title=\"Uploading your image\"\n          message=\"Please wait while we fetch your code\"\n        />\n      </If>\n    </div>\n  )\n}\n\nexport default CameraView\n"]},"metadata":{},"sourceType":"module"}